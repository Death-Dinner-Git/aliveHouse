{__NOLAYOUT__}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">

    <!-- Favicon -->
    <link rel="shortcut icon" href="_SHORTCUT_" type="image/x-icon">

    <!-- load css -->
    <link rel="stylesheet" type="text/css" href="_LAYUI_/css/layui.css" media="all">
    <link rel="stylesheet" type="text/css" href="__CSS__/layout.css" media="all">
    <link rel="stylesheet" type="text/css" href="__CSS__/iconfont.css" media="all">

    <!-- For site js -->
    <script type="text/javascript" src="__JS__/jquery.js"></script>
    <script type="text/javascript" src="__JS__/bootstrap.js"></script>
    <script type="text/javascript" src="_LAYUI_/layui.js"></script>

    <title>{$meta_title ? $meta_title.' - ' : ''}_TITLE_</title>

    <style>
        #CreateForm .layui-form-item{
            font-size: 14px;
        }
        #CreateForm .layui-form-item .layui-form-label{
            width: 130px;
        }
        #CreateForm .layui-form-item .layui-input-block{
            margin-left: 160px;
        }
        #CreateForm .layui-form-item .layui-input-inline{
            width: 220px;
        }
        #CreateForm .layui-form-item .layui-input-inline .layui-input{
            font-size: 14px;
        }
        .help-hint{
            display: block;
            width: 100%;
            padding-left: 30px;
            height: 38px;
            line-height: 38px;
            border-radius: 2px;
            text-align: left;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
        .help-msg .fa{
            position: absolute;
            border-radius: 50%;
            margin: 10px;
            width: 14px;
            height: 14px;
            text-align: center;
            vertical-align: middle;
        }
        .help-msg .fa.fa-close,.help-msg .fa.fa-check{
            border: 1px solid #d4d4d4;
        }
        .help-msg .fa-close:before{
            color: #E85445;
        }
        .help-msg .fa-check:before{
            color: #0DBD9F;
        }
    </style>

</head>

<body>

<section style="max-width:1200px;margin: 30px auto;">
    <form class="layui-form" id="defaultForm" style="margin-top: 20px;">

        <div class="layui-form-item">
            <label class="layui-form-label">楼盘地址:</label>
            <div class="layui-input-inline">
                <input type="text" value="" name="Building[address]" lay-verify="required" placeholder="楼盘地址" class="layui-input">
            </div>
            <div class="layui-input-inline help-msg">
                <i class="fa"></i>
                <label class="help-hint"></label>
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">所属城市:</label>
            <div class="layui-input-inline">
                <select name="Building[city_id]" lay-verify="required" lay-search >
                    <option value="">选择城市</option>
                    {volist name="lists" id="item"}
                    <option value="{$key}">{$item}</option>
                    {/volist}
                </select>
            </div>
            <div class="layui-input-inline help-msg">
                <i class="fa"></i>
                <label class="help-hint"></label>
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">楼盘名称:</label>
            <div class="layui-input-inline">
                <input type="text" value="" name="Building[name]" lay-verify="required" placeholder="楼盘名称" class="layui-input">
            </div>
            <div class="layui-input-inline help-msg">
                <i class="fa"></i>
                <label class="help-hint"></label>
            </div>

        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">楼盘地址:</label>
            <div class="layui-input-inline">
                <input type="text" value="" name="Building[address]" lay-verify="required" placeholder="楼盘地址" class="layui-input">
            </div>
            <div class="layui-input-inline help-msg">
                <i class="fa"></i>
                <label class="help-hint"></label>
            </div>
        </div>

        <div class="more-input">

            <div class="layui-form-item layui-form-text">
                <label class="layui-form-label">楼盘描述:</label>
                <div class="layui-input-block">
                    <textarea  name="BuildingDetail[description]" placeholder="请输入楼盘详情" class="layui-textarea" style="max-width: 700px;"></textarea>
                </div>
            </div>

            <div class="layui-form-item">
                <label class="layui-form-label">楼盘图片:</label>
                <div class="layui-input-block">
                    <input type="hidden" value="" name="BuildingDetail[url]" placeholder="楼盘图片" class="layui-input">
                    <input type="file" id="BuildingDetail_file" name="file" placeholder="楼盘图片" class="layui-upload-file">
                    <div lay-filter="show" style="display:none;border: 1px solid #e6e6e6;border-radius: 2px;max-width: 700px;"></div>
                </div>
            </div>

        </div>

        <div class="layui-form-item">
            <label class="layui-form-label"></label>
            <div class="layui-input-inline">
                <button class="layui-btn" lay-submit="" lay-filter="submit">添加</button>
                <button type="reset" class="layui-btn layui-btn-primary">重置</button>
            </div>
        </div>
    </form>

</section>

<script src="__JS__/site.js"></script>
<script>
    $(function () {
        layui.use(['forms'],function () {
            var layer = top.layui.layer || layui.layer;

            //绑定form提交
            var forms = layui.forms().create({ELEM:'#defaultForm'});

            //监听提交
            forms.on('submit(submit)', function (data) {
                console.log(forms);
                var param = data.field || {},$form = $(data.form),url = $form.attr('action'),index;
                if (url === undefined || url === ''){
                    url = '/manage/ajax/phone';
                }

                $.ajax({
                    url:url,
                    type:'POST',
                    data:param,
                    beforeSend:function () {
                        index = top.layer.load(1, {shade:0.1});
                    },
                    success:function (data) {
                    console.log(data);
                        top.layer.close(index);
                        if (data.info !== undefined){
                            top.layer.msg(data.info);
                            if (data.status == '1'){
                                top.window.isReload = true;
                                top.layer.close(top.layer.getFrameIndex(window.name));
                            }
                        }
                    },
                    error:function (data) {
                        top.layer.close(index);
                        top.layer.msg('Most people can not see this message, please share with us! <br> 【God is a girl, please treat her as a lover】');
                    }
                });
                return false;
            });

        });
    });
    Site.uploader({
        success:function (res,input) {
            var $input = $(input);
            $input.closest('.layui-upload-button').hide();
            if (res.code == '1' && res.src !== undefined) {
                $('[lay-filter="show"]').append('<img src="' + res.src + '">').show();
            }
        }
    });
    var showMsg = function (msg,obj,passed) {
        var _fa = 'fa fa-close',config = {icon: 2,shift: 3},showed = false;
        if (obj.type !== 3){
            _fa = 'fa fa-check';
            config.icon = 1;
        }

        if(obj.obj){
            var _parent = obj.obj.parents('.layui-form-item');
            if (_parent && _parent.length > 0){
                showed = true;
                _parent.find('.help-hint').html(msg);
                _parent.find('.fa').attr('class',_fa);
            }
        }
        if (!showed){
            layui.use(['layer'],function () {
                layer.msg(msg,config);
            });
        }
    };

</script>

</body>

</html>